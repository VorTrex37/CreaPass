<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Creapass - Front</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
  </head>
  <body class="p-3">

    <h1 class="text-center mb-4">Créapass - Frontend de démonstration</h1>


    <!-- Password generation options -->
    <div class="card w-50 mx-auto mb-4">
        <div class="card-body">

            <!-- Size -->
            <div class="mb-4">
                <h6 class="card-subtitle mb-2">Longueur du mot de passe :</h6>
                <input type="number" id="passwordSize" class="form-control" placeholder="Par défaut: 20">
            </div>

            <!-- Character sets -->
            <div class="mb-4">
                <h6 class="card-subtitle mb-2">Jeux de caractères :</h6>
                <div class="form-check">
                    <input id="lowercaseCheck" class="form-check-input" type="checkbox">
                    <label class="form-check-label">Lettres [a-z] minuscules</label>
                </div>
                <div class="form-check">
                    <input id="uppercaseCheck" class="form-check-input" type="checkbox">
                    <label class="form-check-label">Lettres [A-Z] majuscules</label>
                </div>
                <div class="form-check">
                    <input id="numberCheck" class="form-check-input" type="checkbox">
                    <label class="form-check-label">Chiffres [0-9]</label>
                </div>
                <div class="form-check">
                    <input id="specialCheck" class="form-check-input" type="checkbox">
                    <label class="form-check-label">Caractères spéciaux</label>
                </div>
            </div>

            <!-- Ignored characters -->
            <div class="mb-4">
                <h6 class="card-subtitle mb-2">Caractères à ignorer :</h6>
                <input type="text" id="passwordIgnoredChars" class="form-control" placeholder="Par défaut: Vide">
            </div>

            <!-- Generate password button -->
            <button type="button" class="btn btn-primary" onclick="getPassword()">Générer</button>
        </div>
    </div>


    <!-- Generated password -->
    <div class="card w-50 mx-auto">
        <div class="card-body">

        <!-- Password -->
        <div class="mb-4">
            <h6 class="card-subtitle mb-1">Mot de passe :</h6>
            <span id="generatedPassword" class="fw-bold"></span>
        </div>

        <!-- Entropy -->
        <div>
            <h6 class="card-subtitle mb-1">Entropie :</h6>
            <span id="generatedEntropy" class="fw-bold"></span>
        </div>

        </div>
    </div>





    <script type = "text/javascript">
        function getPassword() {
            let data = {};

            let size = $("#passwordSize").val();
            if (size > '') {
                data.size = size;
            }

            let allowed = '';
            allowed += ($("#lowercaseCheck").is(":checked") ? 'a' : '');
            allowed += ($("#uppercaseCheck").is(":checked") ? 'A' : '');
            allowed += ($("#numberCheck").is(":checked") ? 'D' : '');
            allowed += ($("#specialCheck").is(":checked") ? 'S' : '');
            if (allowed > '') {
                data.allowed = allowed;
            }

            let filter = $("#passwordIgnoredChars").val();
            if (filter > '') {
                data.filter = filter;
            }

            $.ajax({
                url: "https://localhost:5001/generate",
                method: "POST",
                data: data,
                dataType : "json",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('x-api-key', 'Example de clé');
                },
            }).done(function(response) {
                $("#generatedPassword").text(response.password);
                $("#generatedEntropy").text(response.entropy);
            });
        }
    </script>

  </body>
</html>

